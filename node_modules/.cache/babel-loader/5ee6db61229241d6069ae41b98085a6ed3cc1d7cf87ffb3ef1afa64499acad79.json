{"ast":null,"code":"import*as XLSX from'xlsx';import{useState,useEffect}from'react';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";export default function Exportar(){const[downloadFileName,setDownloadFileName]=useState('legicList');const[registeredLegicData,setRegisteredLegicData]=useState([]);const[isModalOpen,setIsModalOpen]=useState(false);useEffect(()=>{const getRegisteredData=localStorage.getItem('gactiveLegicReadData');if(getRegisteredData){setRegisteredLegicData(JSON.parse(getRegisteredData));}},[]);const handleDownload=()=>{const worksheet=XLSX.utils.json_to_sheet(registeredLegicData);const workbook=XLSX.utils.book_new();XLSX.utils.book_append_sheet(workbook,worksheet,'Sheet 1');XLSX.writeFile(workbook,\"\".concat(downloadFileName,\".xlsx\"));};const resetRegisteredData=()=>{localStorage.removeItem('gactiveLegicReadData');setRegisteredLegicData([]);window.location.reload();};const openModal=()=>setIsModalOpen(true);const closeModal=()=>setIsModalOpen(false);return/*#__PURE__*/_jsxs(\"section\",{className:\"files-management-container\",children:[/*#__PURE__*/_jsx(\"p\",{children:\"Exportar Ficheiros\"}),/*#__PURE__*/_jsx(\"input\",{className:\"download-filename\",placeholder:\"NOME DO FICHEIRO\",onChange:e=>setDownloadFileName(e.target.value)}),/*#__PURE__*/_jsx(\"button\",{className:\"clean-button\",onClick:handleDownload,children:\"Download Excel\"}),/*#__PURE__*/_jsx(\"p\",{children:\"Limpar Leituras\"}),/*#__PURE__*/_jsx(\"button\",{className:\"clean-button\",onClick:resetRegisteredData,children:\"Limpar Lista\"}),registeredLegicData.length>0&&/*#__PURE__*/_jsx(\"section\",{className:\"import-data-table-section\",children:/*#__PURE__*/_jsxs(\"table\",{className:\"import-data-table\",children:[/*#__PURE__*/_jsx(\"thead\",{children:/*#__PURE__*/_jsxs(\"tr\",{children:[/*#__PURE__*/_jsx(\"th\",{children:\"Numero\"}),/*#__PURE__*/_jsx(\"th\",{children:\"Nome\"}),/*#__PURE__*/_jsx(\"th\",{children:\"Legic/Codigo de Barras\"}),/*#__PURE__*/_jsx(\"th\",{children:\"Centro de custo\"})]})}),/*#__PURE__*/_jsx(\"tbody\",{children:registeredLegicData.map((data,index)=>/*#__PURE__*/_jsxs(\"tr\",{children:[/*#__PURE__*/_jsx(\"td\",{children:data[0]}),/*#__PURE__*/_jsx(\"td\",{children:data[1]}),/*#__PURE__*/_jsx(\"td\",{children:data[2]}),/*#__PURE__*/_jsx(\"td\",{children:data[3]})]},index))})]})}),/*#__PURE__*/_jsx(\"i\",{onClick:openModal,className:\"fa fa-question-circle open-modal-icon\"}),isModalOpen&&/*#__PURE__*/_jsx(\"div\",{className:\"modal-overlay\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"modal\",children:[/*#__PURE__*/_jsx(\"h2\",{children:\"Ajuda - Exporta\\xE7\\xE3o\"}),/*#__PURE__*/_jsx(\"p\",{children:\"- Nesta p\\xE1gina, voc\\xEA pode exportar os dados registrados em um arquivo Excel.\"}),/*#__PURE__*/_jsx(\"p\",{children:\"- Insira o nome desejado para o arquivo de exporta\\xE7\\xE3o no campo \\\"NOME DO FICHEIRO\\\".\"}),/*#__PURE__*/_jsx(\"p\",{children:\"- Ao clicar em \\\"Download Excel\\\", o arquivo ser\\xE1 baixado com os dados registrados.\"}),/*#__PURE__*/_jsx(\"p\",{children:\"- Voc\\xEA tamb\\xE9m pode limpar os dados registrados clicando em \\\"Limpar Lista\\\".\"}),/*#__PURE__*/_jsx(\"button\",{onClick:closeModal,className:\"close-modal-button\",children:\"Fechar\"})]})})]});}","map":{"version":3,"names":["XLSX","useState","useEffect","jsx","_jsx","jsxs","_jsxs","Exportar","downloadFileName","setDownloadFileName","registeredLegicData","setRegisteredLegicData","isModalOpen","setIsModalOpen","getRegisteredData","localStorage","getItem","JSON","parse","handleDownload","worksheet","utils","json_to_sheet","workbook","book_new","book_append_sheet","writeFile","concat","resetRegisteredData","removeItem","window","location","reload","openModal","closeModal","className","children","placeholder","onChange","e","target","value","onClick","length","map","data","index"],"sources":["C:/Users/DuaTo/GeberActiv/src/components/exportar/index.js"],"sourcesContent":["import * as XLSX from 'xlsx';\r\nimport { useState, useEffect } from 'react';\r\n\r\nexport default function Exportar() {\r\n    const [downloadFileName, setDownloadFileName] = useState('legicList');\r\n    const [registeredLegicData, setRegisteredLegicData] = useState([]);\r\n    const [isModalOpen, setIsModalOpen] = useState(false); \r\n\r\n    useEffect(() => {\r\n        const getRegisteredData = localStorage.getItem('gactiveLegicReadData');\r\n        if (getRegisteredData) {\r\n            setRegisteredLegicData(JSON.parse(getRegisteredData));\r\n        }\r\n    }, []);\r\n\r\n    const handleDownload = () => {\r\n        const worksheet = XLSX.utils.json_to_sheet(registeredLegicData);\r\n        const workbook = XLSX.utils.book_new();\r\n        XLSX.utils.book_append_sheet(workbook, worksheet, 'Sheet 1');\r\n        XLSX.writeFile(workbook, `${downloadFileName}.xlsx`);\r\n    };\r\n\r\n    const resetRegisteredData = () => {\r\n        localStorage.removeItem('gactiveLegicReadData');\r\n        setRegisteredLegicData([]);\r\n        window.location.reload();\r\n    };\r\n\r\n    \r\n    const openModal = () => setIsModalOpen(true);\r\n    const closeModal = () => setIsModalOpen(false);\r\n\r\n    return (\r\n        <section className='files-management-container'>\r\n            <p>Exportar Ficheiros</p>\r\n\r\n            <input \r\n                className='download-filename' \r\n                placeholder='NOME DO FICHEIRO' \r\n                onChange={(e) => setDownloadFileName(e.target.value)} \r\n            />\r\n            <button className='clean-button' onClick={handleDownload}>Download Excel</button>\r\n            <p>Limpar Leituras</p>\r\n            <button className='clean-button' onClick={resetRegisteredData}>Limpar Lista</button>\r\n\r\n            {registeredLegicData.length > 0 && (\r\n                <section className='import-data-table-section'>\r\n                    <table className='import-data-table'>\r\n                        <thead>\r\n                            <tr>\r\n                                <th>Numero</th>\r\n                                <th>Nome</th>\r\n                                <th>Legic/Codigo de Barras</th>\r\n                                <th>Centro de custo</th>\r\n                            </tr>\r\n                        </thead>\r\n                        <tbody>\r\n                            {registeredLegicData.map((data, index) => (\r\n                                <tr key={index}>\r\n                                    <td>{data[0]}</td>\r\n                                    <td>{data[1]}</td>\r\n                                    <td>{data[2]}</td>\r\n                                    <td>{data[3]}</td>\r\n                                </tr>\r\n                            ))}\r\n                        </tbody>\r\n                    </table>\r\n                </section>\r\n            )}\r\n\r\n            {}\r\n            <i onClick={openModal} className=\"fa fa-question-circle open-modal-icon\" />\r\n\r\n            {}\r\n            {isModalOpen && (\r\n                <div className=\"modal-overlay\">\r\n                    <div className=\"modal\">\r\n                        <h2>Ajuda - Exportação</h2>\r\n                        <p>- Nesta página, você pode exportar os dados registrados em um arquivo Excel.</p>\r\n                        <p>- Insira o nome desejado para o arquivo de exportação no campo \"NOME DO FICHEIRO\".</p>\r\n                        <p>- Ao clicar em \"Download Excel\", o arquivo será baixado com os dados registrados.</p>\r\n                        <p>- Você também pode limpar os dados registrados clicando em \"Limpar Lista\".</p>\r\n                        <button onClick={closeModal} className=\"close-modal-button\">\r\n                            Fechar\r\n                        </button>\r\n                    </div>\r\n                </div>\r\n            )}\r\n        </section>\r\n    );\r\n}\r\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}